##############################################################################
# GlucoFarmer Dashboard
#
# Anleitung:
#   1. In HA: Einstellungen > Dashboards > Dashboard hinzufuegen
#   2. Name: "GlucoFarmer", Icon: mdi:diabetes
#   3. Dashboard oeffnen > Drei-Punkte-Menue > Raw-Konfigurationseditor
#   4. Diesen Inhalt einfuegen
#   5. Fuer jedes Schwein die ENTITY-IDs anpassen (suche nach "piggy_01")
#
# Entity-ID Konvention:
#   sensor.{pig_name}_glucose_value       -> z.B. sensor.piggy_01_glucose_value
#   sensor.{pig_name}_glucose_trend       -> z.B. sensor.piggy_01_glucose_trend
#   sensor.{pig_name}_glucose_status      -> z.B. sensor.piggy_01_glucose_status
#   sensor.{pig_name}_reading_age         -> z.B. sensor.piggy_01_reading_age
#   sensor.{pig_name}_time_in_range_today -> z.B. sensor.piggy_01_time_in_range_today
#   number.{pig_name}_low_threshold       -> z.B. number.piggy_01_low_threshold
#   button.{pig_name}_preset_*            -> z.B. button.piggy_01_preset_fruehstueck
#
# Fuer weitere Schweine: Abschnitte duplizieren und IDs anpassen.
##############################################################################

views:
  ##########################################################################
  # SEITE 1: UEBERSICHT
  ##########################################################################
  - title: Uebersicht
    path: overview
    icon: mdi:view-dashboard
    badges: []
    cards:
      # -- Header --
      - type: markdown
        content: "# GlucoFarmer - Uebersicht"

      # ---- Schwein 1: Piggy-01 ----
      - type: vertical-stack
        cards:
          - type: markdown
            content: "## Piggy-01"

          - type: horizontal-stack
            cards:
              # Glucose Gauge
              - type: gauge
                entity: sensor.piggy_01_glucose_value
                name: Glucose
                unit: mg/dL
                min: 20
                max: 350
                severity:
                  green: 70
                  yellow: 55
                  red: 0
                needle: true
                segments:
                  - from: 0
                    color: red
                    label: Kritisch
                  - from: 55
                    color: orange
                    label: Niedrig
                  - from: 70
                    color: green
                    label: Normal
                  - from: 180
                    color: orange
                    label: Hoch
                  - from: 250
                    color: red
                    label: Sehr hoch

              # Trend + Status
              - type: entities
                entities:
                  - entity: sensor.piggy_01_glucose_value
                    name: Aktueller Wert
                  - entity: sensor.piggy_01_glucose_trend
                    name: Trend
                  - entity: sensor.piggy_01_glucose_status
                    name: Status
                  - entity: sensor.piggy_01_reading_age
                    name: Datenalter

          # Mini-Verlaufsgraph
          - type: history-graph
            entities:
              - entity: sensor.piggy_01_glucose_value
                name: Piggy-01
            hours_to_show: 6
            logarithmic_scale: false

      # ---- Schwein 2: Piggy-02 (Vorlage - bei Bedarf aktivieren) ----
      # - type: vertical-stack
      #   cards:
      #     - type: markdown
      #       content: "## Piggy-02"
      #     - type: horizontal-stack
      #       cards:
      #         - type: gauge
      #           entity: sensor.piggy_02_glucose_value
      #           name: Glucose
      #           unit: mg/dL
      #           min: 20
      #           max: 350
      #           needle: true
      #           severity:
      #             green: 70
      #             yellow: 55
      #             red: 0
      #           segments:
      #             - from: 0
      #               color: red
      #             - from: 55
      #               color: orange
      #             - from: 70
      #               color: green
      #             - from: 180
      #               color: orange
      #             - from: 250
      #               color: red
      #         - type: entities
      #           entities:
      #             - entity: sensor.piggy_02_glucose_value
      #               name: Aktueller Wert
      #             - entity: sensor.piggy_02_glucose_trend
      #               name: Trend
      #             - entity: sensor.piggy_02_glucose_status
      #               name: Status
      #             - entity: sensor.piggy_02_reading_age
      #               name: Datenalter
      #     - type: history-graph
      #       entities:
      #         - entity: sensor.piggy_02_glucose_value
      #           name: Piggy-02
      #       hours_to_show: 6

  ##########################################################################
  # SEITE 2: EINGABE
  ##########################################################################
  - title: Eingabe
    path: input
    icon: mdi:pencil-plus
    badges: []
    cards:
      - type: markdown
        content: "# Eingabe"

      # ---- Piggy-01: Presets ----
      - type: vertical-stack
        cards:
          - type: markdown
            content: "## Piggy-01 - Schnelleingabe"

          - type: horizontal-stack
            cards:
              - type: button
                entity: button.piggy_01_preset_fruehstueck
                name: Fruehstueck
                icon: mdi:food-croissant
                tap_action:
                  action: toggle
                show_state: false

              - type: button
                entity: button.piggy_01_preset_abendessen
                name: Abendessen
                icon: mdi:food-turkey
                tap_action:
                  action: toggle
                show_state: false

              - type: button
                entity: button.piggy_01_preset_novorapid_standard
                name: NovoRapid
                icon: mdi:needle
                tap_action:
                  action: toggle
                show_state: false

          - type: horizontal-stack
            cards:
              - type: button
                entity: button.piggy_01_preset_notfallration_einfach
                name: Notfall 1x
                icon: mdi:alert
                tap_action:
                  action: toggle
                show_state: false

              - type: button
                entity: button.piggy_01_preset_notfallration_doppelt
                name: Notfall 2x
                icon: mdi:alert-plus
                tap_action:
                  action: toggle
                show_state: false

      # ---- Manuelle Eingabe (Services) ----
      - type: vertical-stack
        cards:
          - type: markdown
            content: "## Manuelle Eingabe"
          - type: markdown
            content: >
              Fuer manuelle Eingaben nutze die HA-Dienste:

              - **Entwicklerwerkzeuge > Dienste > `glucofarmer.log_insulin`**

              - **Entwicklerwerkzeuge > Dienste > `glucofarmer.log_feeding`**

              - **Entwicklerwerkzeuge > Dienste > `glucofarmer.delete_event`**

      # ---- Aktuelle Werte als Kontext ----
      - type: entities
        title: Piggy-01 - Aktuell
        show_header_toggle: false
        entities:
          - entity: sensor.piggy_01_glucose_value
            name: Glucose
          - entity: sensor.piggy_01_glucose_trend
            name: Trend
          - entity: sensor.piggy_01_glucose_status
            name: Status
          - entity: sensor.piggy_01_daily_insulin_total
            name: Insulin heute
          - entity: sensor.piggy_01_daily_bes_total
            name: BE heute

  ##########################################################################
  # SEITE 3: STATISTIKEN
  ##########################################################################
  - title: Statistiken
    path: stats
    icon: mdi:chart-bar
    badges: []
    cards:
      - type: markdown
        content: "# Tages-Statistiken"

      # ---- Piggy-01 Statistiken ----
      - type: vertical-stack
        cards:
          - type: markdown
            content: "## Piggy-01"

          # TIR / TBR / TAR
          - type: horizontal-stack
            cards:
              - type: gauge
                entity: sensor.piggy_01_time_in_range_today
                name: TIR
                unit: "%"
                min: 0
                max: 100
                severity:
                  green: 70
                  yellow: 50
                  red: 0
                needle: true

              - type: gauge
                entity: sensor.piggy_01_time_below_range_today
                name: TBR
                unit: "%"
                min: 0
                max: 100
                severity:
                  green: 0
                  yellow: 5
                  red: 10
                needle: true

              - type: gauge
                entity: sensor.piggy_01_time_above_range_today
                name: TAR
                unit: "%"
                min: 0
                max: 100
                severity:
                  green: 0
                  yellow: 15
                  red: 25
                needle: true

          # Datenvollstaendigkeit + Summen
          - type: entities
            entities:
              - entity: sensor.piggy_01_data_completeness_today
                name: Datenvollstaendigkeit
              - entity: sensor.piggy_01_daily_insulin_total
                name: Insulin gesamt (IU)
              - entity: sensor.piggy_01_daily_bes_total
                name: Fuetterung gesamt (BE)

          # 24h Verlauf
          - type: history-graph
            title: Glucose-Verlauf (24h)
            entities:
              - entity: sensor.piggy_01_glucose_value
                name: Piggy-01
            hours_to_show: 24

      # ---- Piggy-02 Statistiken (Vorlage) ----
      # Abschnitt duplizieren und "piggy_01" durch "piggy_02" ersetzen

  ##########################################################################
  # SEITE 4: EINSTELLUNGEN
  ##########################################################################
  - title: Einstellungen
    path: settings
    icon: mdi:cog
    badges: []
    cards:
      - type: markdown
        content: "# Einstellungen"

      # ---- Piggy-01 Schwellwerte ----
      - type: entities
        title: "Piggy-01 - Schwellwerte"
        show_header_toggle: false
        entities:
          - entity: number.piggy_01_low_threshold
            name: Untere Grenze (mg/dL)
          - entity: number.piggy_01_high_threshold
            name: Obere Grenze (mg/dL)
          - entity: number.piggy_01_critical_low_threshold
            name: Kritisch niedrig (mg/dL)
          - entity: number.piggy_01_data_timeout
            name: Daten-Timeout (Minuten)

      # ---- Kataloge & Presets ----
      - type: markdown
        content: >
          ## Kataloge und Presets verwalten

          Insulin-Produkte, Fuetterungskategorien und Presets werden ueber
          den **Options Flow** der Integration verwaltet:

          **Einstellungen > Geraete & Dienste > GlucoFarmer > Konfigurieren**

          Dort kannst du:

          - Insulin-Produkte hinzufuegen/entfernen

          - Fuetterungskategorien hinzufuegen/entfernen

          - Presets erstellen/loeschen

      # ---- Piggy-02 Schwellwerte (Vorlage) ----
      # - type: entities
      #   title: "Piggy-02 - Schwellwerte"
      #   show_header_toggle: false
      #   entities:
      #     - entity: number.piggy_02_low_threshold
      #       name: Untere Grenze (mg/dL)
      #     - entity: number.piggy_02_high_threshold
      #       name: Obere Grenze (mg/dL)
      #     - entity: number.piggy_02_critical_low_threshold
      #       name: Kritisch niedrig (mg/dL)
      #     - entity: number.piggy_02_data_timeout
      #       name: Daten-Timeout (Minuten)
